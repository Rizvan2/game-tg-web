<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Gameplay Room</title>
    <style>
        .arena { display: flex; justify-content: space-around; margin-top: 50px; }
        .player { text-align: center; }
        #imgPlayer1 { width: 150px; height: 150px; }
        #imgPlayer2 { width: 250px; height: 250px; } /* увеличиваем врага */
    </style>

</head>
<body>
<h1>Комната: <span id="roomIdSpan"></span></h1>

<div class="arena">
    <div class="player" id="player1">
        <h2>Вы</h2>
        <img id="imgPlayer1" src="/images/player1.png" alt="Player 1">
    </div>
    <div class="player" id="player2">
        <h2>Противник</h2>
        <img id="imgPlayer2" src="/images/player2.png" alt="Player 2">
    </div>
</div>
<div id="messages" style="margin-top:30px; font-family: Arial, sans-serif;"></div>

<script>
    // Получаем id комнаты из query-параметра
    const params = new URLSearchParams(window.location.search);
    const gameCode = params.get('id');

    const roomIdSpan = document.getElementById('roomIdSpan');
    roomIdSpan.textContent = gameCode ? gameCode : '—';

    const messagesDiv = document.getElementById('messages');

    function addMessage(text) {
        const p = document.createElement('p');
        p.textContent = text;
        messagesDiv.appendChild(p);
    }

    if (!gameCode) {
        addMessage('Не указан код комнаты. Вернитесь на главную страницу.');
    } else {
        // Открываем WebSocket-соединение к комнате
        const wsProtocol = location.protocol === 'https:' ? 'wss' : 'ws';
        const wsUrl = `${wsProtocol}://${location.host}/ws/duel?gameCode=${encodeURIComponent(gameCode)}`;
        const socket = new WebSocket(wsUrl);

        socket.onopen = () => {
            addMessage('Подключение к комнате установлено. Ожидаем игроков...');
        };

        socket.onmessage = (event) => {
            addMessage(event.data);
        };

        socket.onerror = () => {
            addMessage('Ошибка WebSocket-соединения.');
        };

        socket.onclose = () => {
            addMessage('Соединение закрыто.');
        };
    }
</script>

</body>
</html>
