<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" charset="UTF-8">
  <link rel="stylesheet" href="css/index.css">

  <title>Duel Page</title>

</head>
<body>
<form id="logoutForm" action="/logout" method="post" style="position: fixed; top: 20px; right: 20px;">
  <button type="submit" id="logoutBtn" onclick="return confirm('Вы уверены, что хотите выйти?')">Выйти из аккаунта</button>
</form>

<h1>Duel Game</h1>

<input type="text" id="roomId" placeholder="Название комнаты">
<button id="duelBtn">Присоединиться / Создать</button>
<a href="/lobby.html">
  <button type="button">Лобби</button>
</a>
<!-- Новая кнопка выбора персонажа -->
<button id="selectCharacterBtn">Выбрать персонажа</button>
<p id="status"></p>
<script>
  const duelBtn = document.getElementById('duelBtn');
  const selectCharacterBtn = document.getElementById('selectCharacterBtn');

  // --- Запуск дуэли ---
  duelBtn.addEventListener('click', async () => {
    const roomId = document.getElementById('roomId').value.trim();
    if (!roomId) {
      status.textContent = 'Введите код комнаты!';
      return;
    }

    try {
      const response = await fetch(`/StartDuel`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
        body: new URLSearchParams({ gameCode: roomId })
      });

      if (!response.ok) throw new Error('Ошибка при запуске дуэли');

      window.location.href = `/duel-battle.html?gameCode=${encodeURIComponent(roomId)}`;
    } catch (e) {
      status.textContent = 'Ошибка: ' + e.message;
    }
  });

  // --- Выбор персонажа ---
  selectCharacterBtn.addEventListener('click', () => {
    window.location.href = "character-selection.html";
  });
</script>

</body>
</html>
