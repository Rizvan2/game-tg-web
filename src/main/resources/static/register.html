<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" charset="UTF-8">
  <title>Регистрация</title>
  <link rel="stylesheet" href="css/register.css">

</head>
<body>
<h1>Register</h1>

<input type="text" id="username" placeholder="Username" required>
<input type="password" id="password" placeholder="Password" required>
<button id="registerBtn">Зарегистрироваться</button>
<button id="login" style="margin-top: 15px;">Уже есть аккаунт</button>
<p id="status"></p>

<script>
  document.getElementById('registerBtn').addEventListener('click', async () => {
    const username = document.getElementById('username').value.trim();
    const password = document.getElementById('password').value.trim();
    const status = document.getElementById('status');

    if (!username || !password) {
      status.textContent = '❗ Заполните все поля';
      status.style.color = 'red';
      return;
    }

    try {
      const response = await fetch('/register', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({username: username, password: password})
      });

      if (response.ok) {
        window.location.href = '/index.html';
      } else {
        const data = await response.text();
        status.textContent = 'Ошибка регистрации: ' + data;
        status.style.color = 'red';
      }
    } catch (e) {
      status.textContent = 'Ошибка соединения с сервером';
      status.style.color = 'red';
    }
  });

  document.getElementById('login').addEventListener('click', () => {
    window.location.href = '/login.html';
  });
</script>
</body>
</html>
